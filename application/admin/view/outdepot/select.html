<form action="{:url('save')}" class="form-select">

    <div class="row">
        <div class="col-md-6">
            
            <div class="form-group">
                <label for="field-1" class="control-label">编号</label>
                <input type="text" class="form-control" name="sn" placeholder="编号" value="">
            </div>	
            
        </div>

        <div class="col-md-6">
            <div class="form-group">
                <label for="field-2" class="control-label">名称</label>
                
                <input type="text" class="form-control" name="name" placeholder="名称">
            </div>	
        </div>


    </div>

    <div class="row">

        <div class="col-md-6"> 
            <div class="form-group">
                <label class="control-label">分类</label>
                <select class="form-control comboSelect" name="cate">
                    <option value="">请选择</option>
                    {volist name="cate" id="vo"}
                    <option value="{$vo.id}">{$vo.name}</option>
                    {/volist}
                </select>
            </div>	
        </div>

        <div class="col-md-6">
            <div class="form-group">
                <label class="control-label">品牌</label>
                <select class="form-control comboSelect" name="brand">
                    <option value="">请选择</option>
                    {volist name="brand" id="vo"}
                    <option value="{$vo.id}">{$vo.name}</option>
                    {/volist}
                </select>
            </div>	
        </div>

    </div>

    <div class="row">
        <div class="col-md-12">
            <button class="btn btn-sm btn-info" type="button" @click="searchData()" >
                <!-- <i class="fa fa-plus"> </i> -->
                <span class="hidden-xs hidden-sm">查询</span>
            </button>
        </div>
    </div>

    <div class="row" v-show="table.length>0">

        <div class="col-md-12" > 
            <table class="table table-bordered table-striped text-center">
                <thead>
                    <tr >
                        <th></th>
                        <th>编号</th>
                        <th>名称</th>
                        <th>品牌</th>
                        <th>型号</th>
                        <th>价格</th>
                        <th>单位</th>
                    </tr >
                </thead>
                
                <tbody>

                    <tr v-for="(item,key) in table">
                        <td>
                            <button class="btn btn-sm btn-info" type="button" @click="selectLine(key)" >
                                <span class="hidden-xs hidden-sm">选择</span>
                            </button>
                            <input type="hidden" name="p_id" :value="item.id">
                        </td>
                        <td v-text="item.sn">-</td>
                        <td v-text="item.name">华为</td>
                        <td v-text="item.brand_name">华为</td>
                        <td v-text="item.model">v30</td>
                        <td v-text="item.price">20</td>
                        <td v-text="item.unit_name">个</td>
                    </tr>
                    
                </tbody>
            </table>
        </div>


    </div>    


</form>
<script>
// seajs
seajs.use(['vendor/comboSelect/jquery.combo.select'], function() {

    var select = new Vue({
        el: '.form-select',
        data: {
            table: []
        },
        mounted: function (){
            $('.comboSelect').comboSelect();
        },
        methods: {
            selectLine: function(key){
                // console.log(create.table[create.currentIndex]);
                // console.log(this.table[key]);
                // 选择key保存到数组 
                if(!in_array(this.table[key].id,select_ids)){
                    // select_ids.push(this.table[key].id);
                    create.setLine(create.currentIndex,this.table[key]);
                    $('#modal-select').modal('hide');
                }else{
                    toastr.error("你已经选择过此产品");
                }
                // console.log(select_ids);

            },
            searchData: function(){
                var that = this;
                var data = $(".form-select").serializeArray();
                $.post("{:url('search')}", data,function(resp){
                    that.table = resp.rows;
                }, "json");
            }
        }

    }); 

});
</script>